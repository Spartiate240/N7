#!/bin/sh

ulimit -u 5000

if [ $# -ne 4 ] ; then
	echo "usage : eratotest <début> <borne> <pas> <répertoire>"
    exit 1
fi

if [ -d $4 ] ; then
	rep=$4
	pas=$3
	borne=$2
	debut=$1
	#cd $4
	for f in $4/* ; do
		echo "$f"
		echo "================"
		max=$debut
		while [ $max -le $borne ] ; do
			echo -n 'max : '$max' | '
			/usr/bin/time -f 'temps consommé : %U, %P CPU' $f $max > /dev/null
			max=`expr $max + $pas`
		done
	done		
else
	echo "le dernier paramètre doit être un répertoire"
	exit 2
fi
